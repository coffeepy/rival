{"id":"rival-0wx","title":"Fix cancellation race - cancelled workflows can finish as completed","description":"cancel() sets status to 'cancelled' in workflow-coordinator.ts:213, but run() never checks cancelled state inside its execution loop and unconditionally sets 'completed' at the end (line 181).\n\nResult: cancelled workflows can finish as 'completed', defeating the purpose of cancellation.\n\nFix: Check c.state.status === 'cancelled' at the top of each iteration in the plan execution loop. Break out and return {status: 'cancelled'} if detected.\n\nFiles: src/rival/core/workflow-coordinator.ts\nFound by: Codex review\nSeverity: High","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:08.12199-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:08.12199-06:00","labels":["bug","high-priority"]}
{"id":"rival-5tw","title":"Enforce unique step names at builder/compile time","description":"Duplicate step names silently corrupt execution. Actor names are generated as {workflow}_{stepName} in compiler.ts:41 - duplicates overwrite actor entries. At runtime, workflow-coordinator.ts:142 reuses the same key for step instances.\n\nResult: step collisions, wrong actor/function execution, state bleed across nodes.\n\nFix: Add validation in WorkflowBuilder.step() and/or compileWorkflow() to reject duplicate step names with a clear error message.\n\nFiles: src/rival/builder/workflow-builder.ts, src/rival/builder/compiler.ts\nFound by: Codex review\nSeverity: High","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:02.36434-06:00","created_by":"behrooz","updated_at":"2026-02-08T18:49:41.057058-06:00","labels":["bug","high-priority"]}
{"id":"rival-90s","title":"Replace console.log with pino logger in workflow-coordinator","description":"The coordinator uses raw console.log for all logging (9 call sites in src/rival/core/workflow-coordinator.ts). Should use pino like the step actors do via createStepLogger. Need to wire up a coordinator-level logger variant and replace all console.log calls.","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T18:44:30.984414-06:00","created_by":"behrooz","updated_at":"2026-02-08T18:44:30.984414-06:00","labels":["enhancement"]}
{"id":"rival-988","title":"Reset stale error metadata on workflow rerun","description":"run() in workflow-coordinator.ts resets some fields (status, input, stepResults, currentStepIndex) but not error, failedStep, or completedAt before starting execution (line 90 onward).\n\nResult: getState() may expose stale failure details from a previous run after a successful rerun.\n\nFix: Reset error=null, failedStep=null, completedAt=null at the start of run().\n\nFiles: src/rival/core/workflow-coordinator.ts\nFound by: Codex review\nSeverity: Medium","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:20.306328-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:20.306328-06:00","labels":["bug"]}
{"id":"rival-aox","title":"Implement timeout, onTimeout, and onError in StepConfig","description":"StepConfig defines timeout, onTimeout, and onError (src/rival/types/step.ts:18-31) but createStepActor only uses maxAttempts and backoff (step-actor.ts:78). WorkflowDefinition.onError (workflow.ts:21) is also never used by compiler or coordinator.\n\nThe API promises behavior the runtime does not implement. Either implement these features or remove/deprecate them from the types until they are.\n\nFiles: src/rival/core/step-actor.ts, src/rival/core/workflow-coordinator.ts, src/rival/builder/compiler.ts, src/rival/types/step.ts\nFound by: Codex review\nSeverity: High","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:14.475224-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:14.475224-06:00","labels":["enhancement","high-priority"]}
{"id":"rival-kr3","title":"Implement branch/loop/parallel execution in coordinator","description":"Plan types for BranchPlanNode, LoopPlanNode, and ParallelPlanNode are defined in types/plan.ts but the coordinator only handles type='step' nodes. There's a TODO comment at workflow-coordinator.ts:111.\n\nThis is the main feature gap for making Rival a full workflow engine. Needs:\n- BranchSupervisor: evaluate condition actor, execute then/else path\n- LoopSupervisor: execute body repeatedly until condition is false  \n- ParallelSupervisor: spawn all children concurrently, await all results\n\nFiles: src/rival/core/workflow-coordinator.ts, src/rival/types/plan.ts\nFrom: redesign.md design spec\nSeverity: Feature - Future phase","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:43.023879-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:43.023879-06:00","labels":["enhancement","feature"],"dependencies":[{"issue_id":"rival-kr3","depends_on_id":"rival-qr7","type":"blocks","created_at":"2026-02-08T12:31:01.771712-06:00","created_by":"behrooz"},{"issue_id":"rival-kr3","depends_on_id":"rival-0wx","type":"blocks","created_at":"2026-02-08T12:31:01.863692-06:00","created_by":"behrooz"},{"issue_id":"rival-kr3","depends_on_id":"rival-aox","type":"blocks","created_at":"2026-02-08T12:31:01.95467-06:00","created_by":"behrooz"}]}
{"id":"rival-lap","title":"Build Rival Engine - standalone executable with UI","description":"The two-tier vision has Rival Library (done) and Rival Engine (not started). The engine would be a standalone executable with a web UI for:\n\n- Workflow monitoring dashboard\n- Live step execution visualization\n- Log viewing (mockups exist in mockups/ui-mockup-logs.html)\n- Workflow launching and management\n- Nested workflow visualization (mockups/ui-mockup-nested.html)\n\nUI mockups already exist in mockups/ directory. Plan AST is already serializable for UI consumption. WebSocket integration was explored in earlier commits.\n\nFiles: mockups/\nFrom: redesign.md, .claude/RIVAL.md\nSeverity: Feature - Future phase","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:50.457537-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:50.457537-06:00","labels":["enhancement","feature"],"dependencies":[{"issue_id":"rival-lap","depends_on_id":"rival-kr3","type":"blocks","created_at":"2026-02-08T12:31:05.65873-06:00","created_by":"behrooz"},{"issue_id":"rival-lap","depends_on_id":"rival-u2e","type":"blocks","created_at":"2026-02-08T12:31:05.773266-06:00","created_by":"behrooz"}]}
{"id":"rival-qr7","title":"Fix StepError continue behavior - coordinator treats all failures as terminal","description":"StepError with behavior='continue' returns {status: 'failed'} from step-actor.ts:131, and workflow-coordinator.ts:155 treats ALL failed steps as terminal, stopping the workflow. The documented contract says 'continue' should let the workflow proceed past the failed step.\n\nFix: coordinator should check if the step failure originated from a StepError with behavior='continue' and proceed to the next step instead of stopping.\n\nFiles: src/rival/core/step-actor.ts, src/rival/core/workflow-coordinator.ts\nFound by: Codex review\nSeverity: High","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-02-08T12:29:56.188057-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:52:42.463052-06:00","labels":["bug","high-priority"]}
{"id":"rival-u2e","title":"Add comprehensive test coverage for missing semantics","description":"Current test suite misses critical semantic paths:\n\n- No tests for StepError.behavior === 'continue' (workflow should proceed)\n- No tests for duplicate step names (should error at build/compile time)\n- No tests for cancellation during execution (race condition)\n- No tests for workflow rerun with stale state\n- Tests are script-style (process.exit) rather than granular bun:test cases\n\nFix: Add focused test cases for each semantic gap. Consider migrating to bun test framework with describe/it/expect for better isolation and reporting.\n\nFiles: test/\nDepends on: rival-qr7, rival-5tw, rival-0wx, rival-988\nFound by: Codex review\nSeverity: Medium","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:35.543452-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:35.543452-06:00","labels":["enhancement","testing"],"dependencies":[{"issue_id":"rival-u2e","depends_on_id":"rival-qr7","type":"blocks","created_at":"2026-02-08T12:30:57.640795-06:00","created_by":"behrooz"},{"issue_id":"rival-u2e","depends_on_id":"rival-5tw","type":"blocks","created_at":"2026-02-08T12:30:57.740822-06:00","created_by":"behrooz"},{"issue_id":"rival-u2e","depends_on_id":"rival-0wx","type":"blocks","created_at":"2026-02-08T12:30:57.850232-06:00","created_by":"behrooz"},{"issue_id":"rival-u2e","depends_on_id":"rival-988","type":"blocks","created_at":"2026-02-08T12:30:57.945419-06:00","created_by":"behrooz"}]}
{"id":"rival-y5z","title":"Fix test environment - RivetKit EPERM on inspector token write","description":"Tests fail with EPERM when RivetKit tries to write inspector token to ~/Library/Application Support/rivetkit/.../inspector-token. This is the actual root cause of the test failures (not a c.client() API issue as initially suspected).\n\nTests pass when run with HOME=/tmp.\n\nFix: Configure test setup to override RivetKit storage path, or add a test helper that sets up a temp directory. This makes tests portable and CI-friendly.\n\nFiles: test/phase1.test.ts, test/phase2.test.ts, test/phase3.test.ts, test/phase4.test.ts\nFound by: Codex test run\nSeverity: Medium","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-08T12:30:28.199912-06:00","created_by":"behrooz","updated_at":"2026-02-08T12:30:28.199912-06:00","labels":["bug","testing"]}
